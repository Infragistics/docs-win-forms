////

|metadata|
{
    "name": "winexplorerbar-add-items-using-code",
    "controlName": ["WinExplorerBar"],
    "tags": ["How Do I"],
    "guid": "{96AE3376-0871-49E8-8044-1BED65A05A64}",  
    "buildFlags": [],
    "createdOn": "2005-07-07T00:00:00Z"
}
|metadata|
////

= コードによる Items の追加

ランタイムに WinExplorerBar で pick:[win-forms="link:{ApiPlatform}win.ultrawinexplorerbar{ApiVersion}~infragistics.win.ultrawinexplorerbar.ultraexplorerbaritem.html[Items]"]  を pick:[win-forms="link:{ApiPlatform}win.ultrawinexplorerbar{ApiVersion}~infragistics.win.ultrawinexplorerbar.ultraexplorerbargroup.html[Group]"]  に追加するには、いくつかの方法があります。項目は個々の Group オブジェクトの Items コレクションに含まれており、標準のコレクション メソッドを使用して項目を追加したり、項目で作業できます。また、項目はエレメントのレイアウトの一部でもあり、バイナリ ファイルまたは XML ファイルに保存されたレイアウトを復元することによって作成することもできます。

項目を追加するためには、最初にどのグループに項目を追加するのかを決定する必要があります。グループにはエレメントの Groups コレクションを通じてアクセスできます。項目を含んでいるグループに Key 値が設定されている場合は、そのキーを使用することで、作業するグループを容易に選択できます。キーが設定されていない場合は、コレクションのインデックスを使用してグループにアクセスできます。また、エレメントの ActiveGroup プロパティを使用して、現在選択されているグループを取得することも可能です。

項目をグループに追加するには、次のいずれかのメソッドを使用します。

* *Items コレクションの Add メソッド* - pick:[win-forms="link:{ApiPlatform}win.ultrawinexplorerbar{ApiVersion}~infragistics.win.ultrawinexplorerbar.ultraexplorerbaritemscollection~add.html[Add]"]  メソッドを呼び出すことで、項目をグループに追加できます。Add メソッドは新しく追加された項目を返すので、それを使用して項目関連のプロパティを設定できます。また、Add メソッドを使用して、特定の pick:[win-forms="link:{ApiPlatform}win.ultrawinexplorerbar{ApiVersion}~infragistics.win.ultrawinexplorerbar.ultraexplorerbaritem~text.html[Text]"]  値と Key 値の両方またはいずれか一方を持つ新しい項目を作成することもできます。

次のコードは、Add メソッドを使用するいくつかの方法を示しています。

*Visual Basic の場合：*

----
Imports Infragistics.Win.UltraWinExplorerBar
...
Private Sub AddItemsThroughCode_Load(ByVal sender As System.Object, _
  ByVal e As System.EventArgs) Handles MyBase.Load
	Dim aGroup As New UltraExplorerBarGroup()
	Dim anItem As New UltraExplorerBarItem()
	aGroup.Text = "Employee Info"
	aGroup.Key = "g_EmployeeInfo"
	Me.UltraExplorerBar1.Groups.Add(aGroup)
	anItem.Key = "i_a_new"
	anItem.Text = "A New Item"
	aGroup.Items.Add(anItem)
	aGroup.Items.Add("i_SteveWalls", "Steve Walls")
End Sub
----

*C# の場合：*

----
using Infragistics.Win.UltraWinExplorerBar;
...
private void AddItemsThroughCode_Load(object sender, System.EventArgs e)
{
	UltraExplorerBarGroup aGroup = new UltraExplorerBarGroup();
	UltraExplorerBarItem anItem = new UltraExplorerBarItem();
	aGroup.Text = "Employee Info";
	aGroup.Key = "g_EmployeeInfo";
	this.ultraExplorerBar1.Groups.Add(aGroup);
	anItem.Key = "i_BeckyJohnson";
	anItem.Text = "Becky Johnson";
	aGroup.Items.Add(anItem);
	aGroup.Items.Add("i_SteveWalls", "Steve Walls");
}
----

image::images\WinExplorerBar_Add_Items_Using_Code_01.png[]

* *Items コレクションの AddRange メソッド* - また Items コレクションは、Item オブジェクトの配列から一度に複数の項目を追加するために使用することができる pick:[win-forms="link:{ApiPlatform}win.ultrawinexplorerbar{ApiVersion}~infragistics.win.ultrawinexplorerbar.ultraexplorerbaritemscollection~addrange.html[AddRange]"]  メソッドもサポートします。このメソッドはエレメントを .NET のフォーム ジェネレータ コードに従ってインスタンス化する機能を提供します。
* *保存したレイアウトから項目をロード* - WinExplorerBar はグループと項目の情報を XML またはバイナリ ファイルのいずれかで保存することができます。後でこのファイルをエレメントにロードし、以前存在したGroupsやそれらに含まれる項目、ならびに他の保存した属性の設定を回復することができます。
* デザインタイムに項目を追加することもできます。詳細については link:winexplorerbar-add-groups-and-items-at-design-time.html[「デザインタイムにグループと項目を追加」]のトピックを参照してください。