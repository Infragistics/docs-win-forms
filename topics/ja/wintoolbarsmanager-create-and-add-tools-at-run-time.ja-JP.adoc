////

|metadata|
{
    "name": "wintoolbarsmanager-create-and-add-tools-at-run-time",
    "controlName": ["WinToolbarsManager"],
    "tags": ["Layouts"],
    "guid": "{5FBFE2E8-1D40-4CB0-BEDD-99D55C003E39}",  
    "buildFlags": [],
    "createdOn": "2005-07-07T00:00:00Z"
}
|metadata|
////

= ランタイムにツールを作成および追加

デザインタイムまたはランタイムのいずれかにツールを作成して、ツールバーおよびメニューに設定および追加できます。新しいツールのインスタンスが作成されたら、それを WinToolbarsManager コンポーネントの Tool コレクションに追加する必要があります。ツールをツールバーに追加するには、ツールバーの Index または Key を指定する必要があり、次に AddTool メソッドを特定のツールバーの Tools コレクションで使用できます。

メニューにツールを追加する時には、ツールはポップアップ メニュー ツールに追加し、次にそのポップアップ メニュー ツールをメイン メニューバーに追加します。メニューまたはツールバーにツールが正しく表示されるようにキャプションまたは画像などの個々のツールのプロパティを設定する必要があります。

*Visual Basic の場合：*

----
Imports Infragistics.Win.UltraWinToolbars
...
Private Sub CreateandAddToolsatRunTime_Load(ByVal sender As System.Object, _
  ByVal e As System.EventArgs) Handles MyBase.Load
	' ツールを作成します。 
	Dim button1 As New ButtonTool("button1")
	Dim textbox1 As New TextBoxTool("textbox1")
	Dim color1 As New PopupColorPickerTool("color1")
	Dim label1 As New LabelTool("label1")
	' これらをツール コレクションに追加します。 
	Me.UltraToolbarsManager1.Tools.Add(button1)
	Me.UltraToolbarsManager1.Tools.Add(textbox1)
	Me.UltraToolbarsManager1.Tools.Add(color1)
	Me.UltraToolbarsManager1.Tools.Add(label1)
	Dim objToolbar As New UltraToolbar("toolbar1")
	Me.UltraToolbarsManager1.Toolbars.AddToolbar("toolbar1")
	label1.SharedProps.Caption = "Label"
	' ツールを指定されたツールバーに追加します。 
	Me.UltraToolbarsManager1.Toolbars("toolbar1").Tools.AddTool("button1")
	Me.UltraToolbarsManager1.Toolbars("toolbar1").Tools.AddTool("textbox1")
	Me.UltraToolbarsManager1.Toolbars("toolbar1").Tools.AddTool("color1")
	Me.UltraToolbarsManager1.Toolbars("toolbar1").Tools.AddTool("label1")
	'** ツールを作成してメニューバーに追加します ** 
	' ツールを作成します。 
	Dim menu1 As New PopupMenuTool("menu1")
	Dim submenu1 As New PopupMenuTool("submenu1")
	Dim button2 As New ButtonTool("button2")
	Dim button3 As New ButtonTool("button3")
	Dim button4 As New ButtonTool("button4")
	Dim objMenuBar As New UltraToolbar("menubar")
	Me.UltraToolbarsManager1.Toolbars.AddToolbar("menubar")
	' これらをツール コレクションに追加します。 
	Me.UltraToolbarsManager1.Tools.Add(menu1)
	Me.UltraToolbarsManager1.Tools.Add(submenu1)
	Me.UltraToolbarsManager1.Tools.Add(button2)
	Me.UltraToolbarsManager1.Tools.Add(button3)
	Me.UltraToolbarsManager1.Tools.Add(button4)
	' メニューに表示される各ツールのキャプションを設定します。 
	menu1.SharedProps.Caption = "Menu1"
	submenu1.SharedProps.Caption = "Submenu1"
	button2.SharedProps.Caption = "button2"
	button3.SharedProps.Caption = "button3"
	button4.SharedProps.Caption = "button4"
	' ツールをメニューに追加します。 
	menu1.Tools.AddTool("submenu1")
	menu1.Tools.AddTool("button2")
	menu1.Tools.AddTool("button3")
	' サブメニューとなるメニュー ツールを追加します。 
	submenu1.Tools.AddTool("button4")
	' メニュー ツールをメニューバーに追加します。 
	Me.UltraToolbarsManager1.Toolbars("menubar").Tools.AddTool("menu1")
End Sub
----

*C# の場合：*

----
using Infragistics.Win.UltraWinToolbars;
...
private void CreateandAddToolsatRunTime_Load(object sender, System.EventArgs e)
{	
	// ツールを作成します。 
	ButtonTool button1 = new ButtonTool("button1");
	TextBoxTool textbox1 = new TextBoxTool("textbox1");
	PopupColorPickerTool color1 = new PopupColorPickerTool("color1");
	LabelTool label1 = new LabelTool("label1");
	// これらをツール コレクションに追加します。 
	this.ultraToolbarsManager1.Tools.Add(button1);
	this.ultraToolbarsManager1.Tools.Add(textbox1);
	this.ultraToolbarsManager1.Tools.Add(color1);
	this.ultraToolbarsManager1.Tools.Add(label1);
	UltraToolbar objToolbar = new UltraToolbar("toolbar1");
	this.ultraToolbarsManager1.Toolbars.AddToolbar("toolbar1");
	label1.SharedProps.Caption = "Label";
	// ツールを指定されたツールバーに追加します。 
	this.ultraToolbarsManager1.Toolbars["toolbar1"].Tools.AddTool("button1");
	this.ultraToolbarsManager1.Toolbars["toolbar1"].Tools.AddTool("textbox1");
	this.ultraToolbarsManager1.Toolbars["toolbar1"].Tools.AddTool("color1");
	this.ultraToolbarsManager1.Toolbars["toolbar1"].Tools.AddTool("label1");
	/* ツールを作成してメニューバーに追加します * /
	// ツールを作成します。
	PopupMenuTool menu1 = new PopupMenuTool("menu1");
	PopupMenuTool submenu1 = new PopupMenuTool("submenu1");
	ButtonTool button2 = new ButtonTool("button2");
	ButtonTool button3 = new ButtonTool("button3");
	ButtonTool button4 = new ButtonTool("button4");
	UltraToolbar objMenuBar = new UltraToolbar("menubar");
	this.ultraToolbarsManager1.Toolbars.AddToolbar("menubar");
	// これらをツール コレクションに追加します。 
	this.ultraToolbarsManager1.Tools.Add(menu1);
	this.ultraToolbarsManager1.Tools.Add(submenu1);
	this.ultraToolbarsManager1.Tools.Add(button2);
	this.ultraToolbarsManager1.Tools.Add(button3);
	this.ultraToolbarsManager1.Tools.Add(button4);
	// メニューに表示される各ツールのキャプションを設定します。 
	menu1.SharedProps.Caption = "Menu1";
	submenu1.SharedProps.Caption = "Submenu1";
	button2.SharedProps.Caption = "button2";
	button3.SharedProps.Caption = "button3";
	button4.SharedProps.Caption = "button4";
	// ツールをメニューに追加します。 
	menu1.Tools.AddTool("submenu1");
	menu1.Tools.AddTool("button2");
	menu1.Tools.AddTool("button3");
	// サブメニューとなるメニュー ツールを追加します。 
	submenu1.Tools.AddTool("button4");
	// メニュー ツールをメニューバーに追加します。 
	this.ultraToolbarsManager1.Toolbars["menubar"].Tools.AddTool("menu1");
}
----

image::images\WinToolbarsManager_Create_and_Add_Tools_at_Run_Time_01.png[]