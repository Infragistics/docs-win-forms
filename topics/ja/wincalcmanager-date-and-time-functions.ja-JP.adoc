////

|metadata|
{
    "name": "wincalcmanager-date-and-time-functions",
    "controlName": ["WinCalcManager"],
    "tags": [],
    "guid": "{228C6107-A461-47E8-8A75-89A0D9FC5A41}",  
    "buildFlags": [],
    "createdOn": "2005-06-07T00:00:00Z"
}
|metadata|
////

= 日付および時間関数

以下の表は、WinCalcManager コントロールによって提供されるすべての Excel® スタイルの日にち関数を、各関数の説明と例とともにリストします。

[options="header", cols="a,a,a,a"]
|====
|関数|説明|解説|例

|[[FUNC_DATE]] 

DATE
|サーバーのローカル時間帯で特定の日付を表すチック数を返します。テキストの日付が問題を生じる可能性があるため日付をテキストとして表す代わりに、この関数を使用してその他の関数に日を表わします。
|*year* 引数には、1 から 9999 の 1 から 4桁で年を指定できます。 

*Month* には、月を表す数値を1 から 12 の範囲で指定します。 

*Day* には、日を表す数値を、1 から 指定した月の最終日を表す数値の範囲で指定します。 

これらのパラメータの正しい範囲外に指定された値はエラーを返します。
|*_例:YEAR(DATE(2008,7,4))*_ - この関数によって _*グレゴリオ_* 暦の 2008 年 7 月 4 日に対応する値を返します (2008)。

|[[FUNC_DATEVALUE]] 

DATEVALUE
|テキストで表された日付のチックの数を返します。 

*DATEVALUE* を使用してテキストで表現されている日付（ _つまり_ MM/DD/YYYY）を他の関数に渡すことができるチックに変換します。
|*date_text* は、日付を表すテキストです。たとえば、二重引用符で囲まれた *"30-Jan-2008"* または *"1/30/2008"* などの文字列は、日付を表します。2 番目の書式で生じる可能性のある曖昧さを避けるために、月をスペルする場合（ _すなわち_ 最初の書式では、「Jan」）、日を表示できるのは Date_text の月の前のみです。Date_text にこの範囲外の値を指定すると、*DATEVALUE* はエラー値 *_#VALUE!_* を返します。 

Date_text の時間情報は無視されます。返されるチックは常に Midnight の時刻を表します（サーバーのローカル時間）。 

Date_text の年の部分を省略すると、*DATEVALUE* はサーバーの内蔵時計による現在の年が使用されます。
|*_Example=MONTH(DATEVALUE("15-Apr-2008"))_* - April 15, 2008 の月の数字を返します (4) 。

|[[FUNC_TIME]] 

TIME
|時間、分、秒数に基づいて特定の時間のチックの時間の値を返します。 

TIME を使用して、チックで表されるその他の日付/時刻値に追加される期間を作成します。
|*Hour* は時間を表す 0（ゼロ）から 23 の数字です。12 より大きい値は午後として解釈されます。 

*Minute* は時間を経過した分を表す 0 から 59 の数字です。 

*Second* は分を経過した秒を表す 0 から 59 の数字です。 

これらの引数が *_#VALUE!_* の範囲外のとき、エラーが返されます。
|*_Example=SECOND(TIME(14,50,5))_* - 時間の値の秒の部分を返します (5) 。

|[[FUNC_TIMEVALUE]] 

TIMEVALUE
|時刻を表すテキスト文字列の時刻の部分を表すチック数を返します。 

時刻値は、チックでも表されるその他の時間または日付/時刻値に追加できる期間として機能することができます。
|*Time_text* は時刻を表す引用符内のテキスト文字列です。 

許容可能な書式の例としては、"5:55 PM" と "17:55" が挙げられます。AM/PM が指定されていない場合には AM であると想定されます（PM の時刻は 24　時間時計に基づいて入力できます。 _つまり_ 、5:00 PM は 17:00 です）。秒の指定はオプションです。時間のセパレータは必須です（"17:00" は許容できますが、"1700" は許容できません）。AM または PM を指定するときには、ピリオドは使用しないでください（"A.M." または "P.M." がエラーを返します）。 

time_text の Date 情報は無視されます。時刻値はチックで表される日付/時刻の値の部分です。*TIMEVALUE* からの戻り値が日付として扱われるときには、最小の日付 January 1st, 1 AD に基づきます。
|*_Example=HOUR(TIMEVALUE("17:00"))_* - 時刻のテキスト表現の時間の部分を返します (17)。

|[[FUNC_DATEAdd]] 

DATEADD
|指定された時間の間隔が追加されているチックの日付と時刻を含む Date 値を返します。
|*Interval* は追加した時間の間隔を表す文字列表現です。可能な値としては、"yyyy"（年）、"y"（年間通算日）、"d"（日）、"w"（週）、"m"（月）、"h"（時間）、"n"（分）、"s"（秒）、"ww"（年の週）、"q"（四半期）が挙げられます。 

*Number* は、どのくらいの間隔を追加するのかを表す実際の数字です。数字は正（未来の日付/時刻の値を取得）、または負（過去の日付/時刻の値を取得）のいずれかにすることができます。interval で時、分、または秒が指定されている場合は、小数部分を含むことができます。その他の interval 値については、 Number の小数部分は無視されます。 

*DateValue* は Date です。間隔が追加される日付/時刻を表す表現です。
|*_Example=DATEADD("h",1.5,NOW( )) -_* 現在から 1 時間 30 分後の日付と時間を表すチックを返します。

|[[FUNC_DATEDIFF]] 

DATEDIFF
|チックで表される 2 つの日付値の間の時間の間隔数を表す整数を返します。
|*Interval* は 2 つの日付の差の単位として使用したい時間の間隔を表す文字列表現です。可能な値としては、"yyyy"（年）、"y"（年間通算日）、"d"（日）、"w"（週）、"m"（月）、"h"（時間）、"n"（分）、"s"（秒）、"ww"（年の週）、"q"（四半期）が挙げられます。 

*Date1, Date2* 引数は、計算で使用したい 2 つの日付/時刻の値です。Date1 の値は、Date2 の値から引いて差を出します。 

*DayOfWeek* は、1（日曜日）から 7（土曜日）の範囲で週の最初の日を指定する列挙体から選択されたオプションの値です。指定しない場合には日曜日 (1) が使用されます。DayOfWeek が 0 の場合、サーバーのローカル設定で構成された週の最初の日が使用されます。*WeekOfYear* は、1 月 1 日(1)、最低 4 日ある週（2）、または最初の丸 1 週間（3）の値を持つ、列挙体から選択されたもうひとつのオプション値です。指定されない場合には 1 月 1 日が使用されます。WeekOfYear が 0 の場合、サーバーのローカル設定で構成された年の週が使用されます。
|*_Example=DATEDIFF("m",DATE(2004,1,1),DATE(2005,3,1))_* - 2004 年 1 月と 2005 年 3 月の間の月の数を返します (14)。

|[[FUNC_DAYS360]] 

DAYS360
|一部の会計アプリケーションで採用されている 1 年 360 日（ひと月が 30 日で 12 ヶ月）に基づく 2 つの日付の間の日数を返します。 

会計システムがひと月 30 日の 12 ヶ月に基づく場合に支払いを計算する際にこの関数を使用します。
|*Start_date* と *end_date* は、間の日数を求める 2 つの日付を指定します（年 360 日に基づいて）。start_date に end_date よりも後の日付を指定すると、*DAYS360* は負の値を返します。日付を入力する際は、*DATE* 関数を使用するか、または他の数式や関数の結果として受け取る必要があります。 

*Method* は、アメリカ（U.S. NASD）方式ではなく計算のヨーロッパ方式を使用するかどうかを示すオプションの引数です。Start_date または End_date のいずれかがその月の 31 日に発生すると、それぞれの回答は若干異なります。デフォルトの Method では、省略されるときには U.S. NASD (") です。 

これらの日付の時間コンポーネントは、サーバーのローカル時間帯で理解されます。
|*_Example=DAYS360(DATE(2005,1,1),DATE(2005,1,31),"TRUE")_* - 1 月 31 日を 1 月 30 日として処理するヨーロッパ方式を使用して 2005 年 1 月 1 日と 2005 年 1 月 31 日の間で 30 日の月がある会計年度で日数を計算します(29)。アメリカ方式を使用すると、異なる答えが出されます (30)。

|[[FUNC_YEAR]] 

YEAR
|日付の年の部分を 1 から 9999 の範囲の整数として返します。
|*serial_number* は、日付/時刻の値を表すチック数です。*Dates* を入力する際は、*DATE* 関数を使用するか、または他の数式や関数の結果として受け取る必要があります。たとえば、2007 年 2 月 14 日では *_DATE(2007,2,14)_* を使用します。日付をテキストで入力した場合、問題が生じることがあります。 

*YEAR*、*MONTH*、*DAY* の各関数から返される値は、指定された日付の表示書式にかかわらず、常に*_グレゴリオ_* 値になります。 

計算で日付/時刻の値が年 9999 を超えると、エラーになります。
|*_Example=YEAR(DATEVALUE("2/14/2007"))_* - 日付の年の部分を返します (2007)。

|[[FUNC_MONth]] 

MONTH
|1（1 月）から12（12 月）の範囲の整数で日付の月の部分を返します。
|*serial_number* は、日付/時刻の値を表すチック数です。*Dates* を入力する際は、*DATE*関数を使用するか、または他の数式や関数の結果として受け取る必要があります。たとえば、2008 年 4 月 15 日では、*_DATE(2008,4,15)_* を使用します。日付を文字列で入力した場合、問題が生じることがあります。 

*YEAR*、*MONTH*、*DAY* の各関数から返される値は、指定された日付の表示書式にかかわらず、常に*_グレゴリオ_* 値になります。
|*_Example=MONTH(DATEVALUE("15-Apr-2008"))_* - 日付の月の部分を返します (4)。

|[[FUNC_DAY]] 

DAY
|日付の日の部分を整数で返します。
|*serial_number* は、日付/時刻の値を表すチック数です。*Dates* を入力する際は、*DATE* 関数を使用するか、または他の数式や関数の結果として受け取る必要があります。たとえば 2006 年 6 月 22 日の場合は、*_DATE(2006,6,22)_* を使用します。日付をテキストで入力した場合には、問題が生じることがあります。 

*YEAR*、*MONTH*、*DAY* の各関数から返される値は、指定された日付の表示書式にかかわらず、常に*_グレゴリオ_* 値になります。
|*_Example=DAY(DATE(2006,6,22))_* - 2006 年 6 月 22 日の日の部分を返します (22)。

|[[FUNC_TODAY]] 

TODAY
|サーバーのローカル時間で、今日の日付を表すチックを返します。返される日付は時間コンポーネントがありません（ _つまり_ 、深夜 0 時のサーバー ローカル時間）。
|日付/時刻の値は、チックの連続カウントとして保存され、計算で使用できます。 

*_NOW( )_* 関数を見て、その時刻コンポーネント _を含む_ 今日の日付を取得します。
|*_Example=HOUR(TODAY( ))_* - この関数は時刻コンポーネントなしの日付値を返すため深夜 0 時を返します (0)。

|[[FUNC_HOUR]] 

HOUR
|時刻値の時間を返します。時間は 0（午前 0 時）から 23（午後 11 時）の範囲の整数となります。0 時を過ぎた時間は 24 時間に基づいて常に返されます。
|*Serial_number* は、検索する時間を含むチックの日時です。時刻値は日付値の一部として、チックで表されます。 

時刻は引用符内にテキスト文字列として入力するか、他の式や関数から受け取る場合があります(たとえば、*_TIMEVALUE("5:55 PM")_* )。
|*_Example=HOUR("2:50:05PM")_* - 時刻の時間の部分を返します (14)。

|[[FUNC_MINUTE]] 

MINUTE
|時刻値の分を返します。分は 0から 59 の範囲の整数となります（少数切り捨て）。
|*Serial_number* には、検索する分を含むチックの日時です。時刻値は日付値の一部として、チックで表されます。 

時刻は引用符内にテキスト文字列として入力するか（たとえば "5:55 PM"）、他の数式や関数から受け取る場合があります（たとえば *_TIMEVALUE("5:55 PM")_* ）。
|*_Example=MINUTE("2:50:05PM")_* - 時刻の分の部分を返します (50)。

|[[FUNC_SECOND]] 

SECOND
|時刻値の秒を返します。秒は 0から 59 の範囲の整数となります（少数切り捨て）。時間で秒が省略されると、0（ゼロ）が想定されます。
|*Serial_number* は、検索する秒を含むチックの日時です。時刻値は日付/時刻値の一部として、チックで表されます。 

時刻は引用符内にテキスト文字列として入力するか（たとえば "5:55 PM"）、他の数式や関数から受け取る場合があります（たとえば *_TIMEVALUE("5:55 PM")_* ）。
|*_Example=SECOND("2:50PM")_* - 時刻の秒の部分を返します (0)。

|[[FUNC_NOW]] 

NOW
|今日の日付と時刻を表すチックを返します（サーバーのローカル時間）。
|日付/時刻の値は、チックの連続カウントとして保存され、計算で使用できます。 

*_TODAY( )_* 関数を見て、その時刻コンポーネント _を含まない_ 今日の日付を取得します。
|*_Example=HOUR(NOW( ))_* - ローカル サーバー時間の現在の時間を返します。

|====

*関連トピック：*

* link:wincalcmanager-financial-functions.html[財務関数]
* link:wincalcmanager-information-functions.html[情報関数]
* link:wincalcmanager-logical-functions.html[論理関数]
* link:wincalcmanager-math-functions.html[算術関数]
* link:wincalcmanager-statistical-functions.html[統計関数]
* link:wincalcmanager-text-and-data-functions.html[テキスト&データ関数]