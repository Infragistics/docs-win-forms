////
|metadata|
{
    "name": "win-upgrading-a-project-to-infragistics-windows-forms-11.1-(and-above)-using-version-utility",
    "controlName": [],
    "tags": ["How Do I"],
    "guid": "6c9a4ab3-1334-4274-b1be-9fb71b0211c7",
    "buildFlags": [],
    "createdOn": "2011-06-03T15:00:00.2144916Z"
}
|metadata|
////

= バージョン ユーティリティの使用

Infragistics は、「バージョン ユーティリティ」と呼ばれる特別なツールを提供しています。このツールによって、既存のソリューションを Infragistics のボリュームに簡単にアップグレードできます。

インストーラーをダウンロードするには、link:https://github.com/Infragistics/winforms-resources[GitHub] にアクセスしてください。

.注:
[NOTE]
====
バージョン ユーティリティ 11.1 は、Infragistics 11.1 以降にプロジェクトをアップグレードするために設計されました。以前のバージョン Infragistics (10.3 など) へアップデートする場合は、そのバージョンのバージョン ユーティリティを使用してください。
====

そのバージョン ユーティリティで以下をアップグレードできます:

* ソリューション
+
単一の Visual Studio™ ソリューションのすべてのプロジェクトおよびプロジェクト ファイルをアップグレードする
* プロジェクト
+
単一の Visual Studio プロジェクトに含まれるすべてのファイルをアップグレードする
* Web サイト
+
単一の Visual Studio Web サイト プロジェクト フォルダー内のすべてのファイルをアップグレードする

使用されるインターフェイス（コマンド ライン インターフェイス、アドイン インターフェイス、およびスタンドアロン アプリケーション）に基づいてユーティリティには 3 つのエディションがあります。これらすべては、同じコアを使用しているので、希望に応じてひとつを選択できます。アップグレード中に行われた変更は、使用されるインターフェイスに関係なく、ログ ファイルに書き込まれます。

このトピックはスタンドアロン インターフェイスの使用方法について説明します。

== 始める前に

コンテンツをアップグレードする前に、以下の点に留意してください:

* Visual Studio のあるバージョンから別のバージョンにソリューションを移行する場合、ユーティリティを使用する前に Visual Studio のアップグレードを実行してください。サポートされる Visual Studio のバージョンは 2008 以降で、このユーティリティは、Infragistics バージョン 2005 以降をアップグレードできます。
* プロジェクトの .Net バージョンをアップグレードする場合には、バージョン ユーティリティを使用する前にこれを実行してください。
* バージョン ユーティリティを実行する前に、ソリューションのファイルが読み取り専用になっていないことを確認してください。ファイルがソース コントロール下にある場合、ユーティリティを起動する前にファイルを確認してください。
* アップグレードしたい Infragistics 製品のバージョンが、アップグレードを実行するために使用するコンピューターにインストールされていることも確認してください。インストールされていない場合は、アップグレードを実行できません。

== 概要

以下は、アップグレード手順の概要です。

. <<Starting,ユーティリティの起動>>

. <<Selecting,コンテンツ タイプの選択>>

. <<Reviewing,アップグレードするファイルの確認>>

. (オプション) <<Customizing,アップグレードのカスタマイズ>>

. <<Performing,アップグレードの実行>>

. <<Finalizing,プロセスの完了>>

== 手順

[[Starting]]
. *ユーティリティの起動*
+
ユーティリティの最初の画面が開きます。選択してください。
[[Selecting]]
. *コンテンツ タイプの選択*
+
アップグレードしたいコンテンツのタイプを選択し、ナビゲートして読み込みます。
+
image::images/VU_Select.png[]
+
図 1: バージョン ユーティリティの選択手順
+
コンテンツが読み込まれたら、バージョン ユーティリティは解析を開始します。解析中は次のような画面が表示します。解析してください。
+
image::images/VU_Analyze.png[]
+
図 2: バージョン ユーティリティの解析手順
+
解析が完了すると、ユーティリティはタスク リストを作成します。これには処理される必要があるファイルの概要を示します。次にステップに進みます。
[[Reviewing]]
. *アップグレードするファイルの確認*
+
各リスト項目を展開してタスクを確認します。
+
image::images/VU_Review_Successful.png[]
+
図 3: バージョン ユーティリティの確認手順
[[Customizing]]
. *(オプション) アップグレードのカスタマイズ*
+
アップグレードをカスタマイズするには、[アップグレード オプション] リンクをクリックします。これによって、[アップグレード オプション] ダイアログが開きます。
+
image::images/VU_Upgrade_Options_Default.png[]
+
図 4: [アップグレード オプション] ダイアログ
+
.注:
[NOTE]
====

* [コントロール アセンブリ パス] オプションを使用して、すべての必要なアセンブリがひとつのフォルダー内にあることを確認します。このユーティリティによって、アセンブリを含むひとつのフォルダーを選択できます。サブフォルダーの再帰的検索はありません。
* カスタム アップブレード オプションを使用したい場合、ユーザーが選択した設定に基づいて新しい解析が実行されます。

====
[[Performing]]
. *アップグレードの実行*
+
解析が完了したら、[アップグレード] ボタンをクリックします。アップグレード処理が開始されます。
+
image::images/VU_Upgrade.png[]
+
図 5: バージョン ユーティリティのアップグレード手順
+
このユーティリティは、ソリューションをアップグレードするために必要なファイルだけを変更します。ソリューション内の以下のファイルだけが変更されます:
+
* プロジェクト ファイル
* app.config
* .licx
* .cs .vb
* .resx

+
処理が完了したら、ユーティリティの最後のステップに進みます。
[[Finalizing]]
. *プロセスの完了*
+
* *変換の成功*
+
すべての識別されたアップグレード タスクが成功すると、バージョン ユーティリティは成功したことを通知し、また変更のログ ファイルへのリンクを提供します。
+
image::images/VU_Finish_Successful.png[]
+
図 6: バージョン ユーティリティの完了手順 - アップグレードの成功
+
バックアップを許可するオプションが有効になっていれば、すべての変更されたファイルはユーティリティの Backup フォルダーにバックアップされています。
+
.注:
[NOTE]
====
[その他のソリューション、プロジェクト、またはウエブサイトをアップグレードする] オプションでは、同じ変換オプションを使用して別のソリューションを変換するための簡単な方法が提供されます。ただし、アップグレード処理に異なる設定が必要な場合には、アプリケーションを終了して新たに実行する必要があります。
====
+ 
この時点で、アプリケーションのソース コードに変更が行われた時に通常講じるのと同じ措置を講じる必要があります。つまり、Microsoft® Visual Studio でアプリケーションを開き、ソース コードを確認して、コンパイルし、そしてテストすることです。

* *変換の失敗*
+
ユーティリティが処理できない状態に遭遇した場合、エラーが発生した時点でアップグレード処理を停止し、状況を通知します。
+
image::images/VU_Finish_Failed.png[]
+
図 7: バージョン ユーティリティの完了手順 - アップグレードの失敗
+
この時点で、ログ ファイルを使用してどのようなエラーが発生したかを識別して、エラーを手動で解決することができます。ログ ファイルに報告されているエラーを解決したら、アップグレード処理を再試行すると、ユーティリティは完了していないアップグレード タスクを処理することができます。もちろん、この方法の代わりに、アプリケーションを手動でアップグレードすることができます。